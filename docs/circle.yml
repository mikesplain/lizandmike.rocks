machine:
  ruby:
    version: 2.4.0


test:
  override:
    - git status
    - git diff
    - bundle exec jekyll doctor
    - git status
    - git diff
    - >
      if [ $(git diff-tree --no-commit-id --name-only @ | grep -v docs | echo $?) ]; then
          git diff-tree --no-commit-id --name-only @ | grep -v docs
          bundle exec jekyll build --destination docs
          git config --global user.email "noreply@lizandmike.rocks"
          git config --global user.name "Circle Ci Docs Build"
          git add .
          git commit -am "Automated docs update"
          git push
      fi

general:
  artifacts:
    - "docs"
